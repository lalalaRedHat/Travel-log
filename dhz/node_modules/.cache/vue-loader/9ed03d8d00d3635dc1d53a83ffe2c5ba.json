{"remainingRequest":"D:\\MyObject\\hai\\Travel-log\\dhz\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\MyObject\\hai\\Travel-log\\dhz\\src\\views\\KeepDiary.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\MyObject\\hai\\Travel-log\\dhz\\src\\views\\KeepDiary.vue","mtime":1606155503503},{"path":"D:\\MyObject\\hai\\Travel-log\\dhz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605537519619},{"path":"D:\\MyObject\\hai\\Travel-log\\dhz\\node_modules\\babel-loader\\lib\\index.js","mtime":1605537519037},{"path":"D:\\MyObject\\hai\\Travel-log\\dhz\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1605537519619},{"path":"D:\\MyObject\\hai\\Travel-log\\dhz\\node_modules\\vue-loader\\lib\\index.js","mtime":1605537543923}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpjb25zdCBjaXR5cyA9IHsNCiAg5rWZ5rGfOiBbJ+adreW3nicsICflroHms6InLCAn5rip5beeJywgJ+WYieWFtCcsICfmuZblt54nXSwNCiAg56aP5bu6OiBbJ+emj+W3nicsICfljqbpl6gnLCAn6I6G55SwJywgJ+S4ieaYjicsICfms4nlt54nXSwNCn07DQpleHBvcnQgZGVmYXVsdCB7DQogIGRhdGEoKXsNCiAgICByZXR1cm4gew0KICAgICAgLy8g5paH56ug5q2j5paHDQogICAgICBhcnRpY2xlOiIiLA0KICAgICAgLy8g5paH56ug5qCH6aKYDQogICAgICBhcnRpY2xlX3RpdDoiIiwNCiAgICAgIC8vIOS4iuS8oOeahOWbvueJhw0KICAgICAgZmlsZUxpc3Q6IFtdLA0KICAgICAgLy8g5b2T5YmN5Z+O5biCDQogICAgICBjdXJyZW50X2NpdHk6IiIsDQogICAgICAvLyBjaXR5OiBbJ+adreW3nicsICflroHms6InLCAn5rip5beeJywgJ+WYieWFtCcsICfmuZblt54nXSwNCiAgICAgIGNpdHk6IFsNCiAgICAgICAgew0KICAgICAgICAgIHZhbHVlczogT2JqZWN0LmtleXMoY2l0eXMpLA0KICAgICAgICAgIGNsYXNzTmFtZTogJ2NvbHVtbjEnLA0KICAgICAgICB9LA0KICAgICAgICB7DQogICAgICAgICAgdmFsdWVzOiBjaXR5c1sn5rWZ5rGfJ10sDQogICAgICAgICAgY2xhc3NOYW1lOiAnY29sdW1uMicsDQogICAgICAgICAgZGVmYXVsdEluZGV4OiAyLA0KICAgICAgICB9LA0KICAgICAgXSwNCiAgICAgIHNob3djaXR5OiBmYWxzZSwNCg0KDQogICAgICAvLyDmlofnq6DliIbnsbsNCiAgICAgIGNsYXNzaWZ5OiIiLA0KICAgICAgZGlhcnljbGFzc2lmeTpbXSwNCiAgICAgIHNob3djbGFzc2lmeTogZmFsc2UsDQogICAgICAvLyDmmK/lkKbkuIrkvKANCiAgICAgIGRhdGE6e30NCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICAvLyDojrflj5blm77niYfor7vlj5blkI7nmoTlj4LmlbANCiAgICBhZnRlclJlYWQoZmlsZSkgew0KICAgICAgY29uc29sZS5sb2coZmlsZSk7DQogICAgICAvLyDliJvlu7rooajljZXmlbDmja7lr7nosaENCiAgICAgIGxldCBmb3JtRGF0YSA9IG5ldyBGb3JtRGF0YSgpOw0KICAgICAgLy8g5aaC5p6c5Lyg55qE5Y+C55qEY29udGVudOWxnuaAp+WtmOWcqOWImeS4uuWvueixoQ0KICAgICAgaWYgKGZpbGUuaGFzT3duUHJvcGVydHkoJ2NvbnRlbnQnKSkgew0KDQogICAgICAgIC8vIOebtOaOpeS/neWtmOWIsGRhdGHkuK0NCiAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdqb3VybmFsX3BpYycsZmlsZS5maWxlKTsNCiAgICAgICAgLy8g5L+d5a2Y5Zyo5Y+Y6YePZGF0YeS4rQ0KICAgICAgICB0aGlzLmRhdGEgPSBmb3JtRGF0YTsNCg0KICAgICAgfSBlbHNlIHsvL+WQpuWImeS4uuaVsOe7hA0KDQogICAgICAgIC8vIOW+queOr+mBjeWOhuiOt+WPlg0KICAgICAgICBmb3IgKGxldCBpID0gMCwgbiA9IGZpbGUubGVuZ3RoOyBpIDwgbjsgaSsrKSB7DQogICAgICAgICAgLy/ojrflj5bliLBGaWxl5a+56LGhDQogICAgICAgICAgbGV0IGZpbGVzID0gZmlsZVtpXS5maWxlOw0KICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGZpbGVbaV0uZmlsZSk7DQogICAgICAgICAgZm9ybURhdGEuYXBwZW5kKCdqb3VybmFsX3BpYycsZmlsZXMpOw0KICAgICAgICB9DQogICAgICAgIC8vIOS/neWtmOWcqOWPmOmHj2RhdGHkuK0NCiAgICAgICAgdGhpcy5kYXRhID0gZm9ybURhdGE7DQoNCiAgICAgIH0NCiAgICB9LA0KDQogICAgDQogICAgLy8g5Z+O5biC6YCJ5oupDQogICAgb25jaXR5KHZhbHVlKSB7DQogICAgICB0aGlzLmN1cnJlbnRfY2l0eSA9IHZhbHVlWzBdICsgdmFsdWVbMV07DQogICAgICB0aGlzLnNob3djaXR5ID0gZmFsc2U7DQogICAgfSwNCiAgICAvLyDliIfmjaLnnIENCiAgICBvbkNoYW5nZShwaWNrZXIsIHZhbHVlcykgew0KICAgICAgcGlja2VyLnNldENvbHVtblZhbHVlcygxLCBjaXR5c1t2YWx1ZXNbMF1dKTsNCiAgICB9LA0KDQoNCg0KDQogICAgLy8g5YiG57G755qE6YCJ5oup5ZmoDQogICAgb25jbGFzc2lmeSh2YWx1ZSl7DQogICAgICB0aGlzLmNsYXNzaWZ5ID0gdmFsdWU7DQogICAgICB0aGlzLnNob3djbGFzc2lmeSA9IGZhbHNlOw0KICAgIH0sDQogICAgLy8g5Y+R5biD5pel5b+XDQogICAgcmVsZWFzZSgpew0KICAgICAgLy8g6I635Y+W55m75b2V54q25oCBDQogICAgICBsZXQgaXNPbmxvZ2luID0gdGhpcy4kc3RvcmUuc3RhdGUuaXNPbmxvZ2luOw0KICAgICAgLy8g5aaC5p6c55m75b2V54q25oCB5Li6MeWImeS4uueZu+W9lQ0KICAgICAgaWYgKCBpc09ubG9naW4gPT0gMSkgew0KICAgICAgICAvLyDojrflj5blvZPliY3ml7bpl7QNCiAgICAgICAgbGV0IGN1cnJlbnRfdGltZSA9IHRoaXMubW9tZW50KCkuZm9ybWF0KCd4Jyk7DQoNCg0KICAgICAgICAvLyDlo7DmmI7kuIDkuKrlj5jph4/kv53lrZjlr7nlupTnmoTliIbnsbtpZA0KICAgICAgICBsZXQgY2xhc3NpZnlfaWQ7DQogICAgICAgIC8vIOS/neWtmOiOt+WPlueahOWIhuexu+aVsOe7hA0KICAgICAgICBsZXQgY2xhc3NpZnlfYXJyID0gdGhpcy4kc3RvcmUuc3RhdGUuY2xhc3NpZnk7DQogICAgICAgIC8vIOW+queOr+WIhuexu+aVsOe7hA0KICAgICAgICBjbGFzc2lmeV9hcnIuZm9yRWFjaCgodmFsdWUsIGluZGV4LCBhcnJheSkgPT4gew0KICAgICAgICAgIC8vIOWmguaenOmAieS4reaWh+eroOWIhuexu+WQjeetieS6juWIhuexu+aVsOe7hOmHjOeahOWQjQ0KICAgICAgICAgIGlmICggdGhpcy5jbGFzc2lmeSA9PSAgdmFsdWUuY2xhc3NpZnkpIHsNCiAgICAgICAgICAgIC8vIOWwseWwhuW9k+WJjWlk6LWL5YC857uZY2xhc3NpZnlfaWQNCiAgICAgICAgICAgIGNsYXNzaWZ5X2lkID0gdmFsdWUuY2lkDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KDQoNCiAgICAgICAgLy8g5b2T5LuA5LmI6YO95rKh5rKh5YaZ5pe25LiN5YWB6K645o+Q5LqkDQogICAgICAgIGlmICggIXRoaXMuYXJ0aWNsZV90aXQgfHwgIXRoaXMuYXJ0aWNsZSB8fCAhdGhpcy5jdXJyZW50X2NpdHkgfHwgIXRoaXMuY2xhc3NpZnkgKSB7DQogICAgICAgICAgLy8g5rKh5YaZ5Lic6KW/5rKh5pyJ5Yqo5L2cDQogICAgICAgICAgdGhpcy4kdG9hc3QuZmFpbCgn6K+35aGr5YaZ5pel5b+X5YaF5a65Jyk7DQogICAgICAgICAgcmV0dXJuDQoNCiAgICAgICAgfSBlbHNlIHsgLy8g5YaZ5LqG5Lic6KW/DQoNCiAgICAgICAgICAgIC8vIOiOt+WPluS/neWtmOeahGZvcm1kYXRhDQogICAgICAgICAgICBsZXQgZm9ybURhdGEgPSB0aGlzLmRhdGE7DQogICAgDQogICAgICAgICAgICAvLyDlnKjooajljZXmlbDmja7lr7nosaHkuK3mt7vliqDmlbDmja4NCiAgICAgICAgICAgIC8vIOaXpeW/l+agh+mimA0KICAgICAgICAgICAgZm9ybURhdGEuc2V0KCJqb3VybmFsX3RpdGxlIix0aGlzLmFydGljbGVfdGl0KTsNCiAgICAgICAgICAgIC8vIOaXpeW/l+ato+aWhw0KICAgICAgICAgICAgZm9ybURhdGEuc2V0KCJjb250ZW50Iix0aGlzLmFydGljbGUpOw0KICAgICAgICAgICAgLy8g5Y+R5biD5pe26Ze0DQogICAgICAgICAgICBmb3JtRGF0YS5zZXQoImxvZ190aW1lIixjdXJyZW50X3RpbWUpOw0KICAgICAgICAgICAgLy8g5b2T5YmN5Z+O5biCDQogICAgICAgICAgICBmb3JtRGF0YS5zZXQoImpvdXJuYWxfY2l0eSIsdGhpcy5jdXJyZW50X2NpdHkpOw0KICAgICAgICAgICAgLy8g5b2T5YmN5YiG57G7DQogICAgICAgICAgICBmb3JtRGF0YS5zZXQoImpvdXJuYWxfY2xhc3NpZnkiLGNsYXNzaWZ5X2lkKTsNCiAgICAgICAgICAgIC8vIOeUqOaIt2lkDQogICAgICAgICAgICBmb3JtRGF0YS5zZXQoInVzZXJzX2lkIiwxKTsNCg0KICAgICAgICAgICAgY29uc29sZS5sb2coZm9ybURhdGEpOw0KICAgICAgICAgICAgLy8g5o+Q5Lqk6KGo5Y2VDQogICAgICAgICAgICB0aGlzLmF4aW9zLnBvc3QoJy9qb3VybmFsL2RpYXJ5YWRkJyxmb3JtRGF0YSkudGhlbiggcmVzID0+IHsNCiAgICAgICAgICAgICAgLy8g6I635Y+W5YiwY29kZeS4ujHot7PovazliLDpppbpobUNCiAgICAgICAgICAgICAgaWYgKHJlcy5kYXRhLmNvZGUgPT0gMSkgew0KICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7DQogICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsDQogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5Y+R5biD5oiQ5YqfJyANCiAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCgnLycpOw0KICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIH0pDQogICAgICAgIH0NCg0KDQogICAgICB9IGVsc2UgeyAvLyDkuLrmnKrnmbvlvZUNCiAgICAgICAgdGhpcy4kdG9hc3QuZmFpbCgn6K+355m75b2V5ZCO5Y+R5biDJyk7DQogICAgICB9DQoNCiAgICB9DQoNCg0KICB9LA0KICBtb3VudGVkKCl7DQogICAgLy8g5YiG57G76YCJ5oup5Zmo6I635Y+W5pWw5o2u5pWw57uEDQogICAgbGV0IGNsYXNzaWZ5cyA9IHRoaXMuJHN0b3JlLnN0YXRlLmNsYXNzaWZ5Ow0KICAgIGNsYXNzaWZ5cy5mb3JFYWNoKCh2YWx1ZSwgaW5kZXgsIGFycmF5KSA9PiB7DQogICAgICB0aGlzLmRpYXJ5Y2xhc3NpZnkucHVzaCh2YWx1ZS5jbGFzc2lmeSkNCiAgICB9KQ0KDQogIH0NCn0NCg=="},{"version":3,"sources":["KeepDiary.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;AAKA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"KeepDiary.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n  <div class=\"keepDiary\">\r\n    <!-- 导航栏 -->\r\n    <van-nav-bar title=\"发布日志\" left-arrow fixed border class=\"navb\">\r\n      <template #left>\r\n        <router-link to=\"/\">\r\n          <van-icon name=\"arrow-left\" color=\"#000\" size=\"24\"  /> \r\n        </router-link>\r\n      </template>\r\n      <template #right>\r\n        <van-button round type=\"info\" size=\"small\" color=\"#5ABCC8\" @click=\"release\">发布</van-button>\r\n      </template>\r\n    </van-nav-bar>\r\n    <!-- 导航栏结束 -->\r\n\r\n    <!-- 正文开始 -->\r\n    <div class=\"diarytext\">\r\n      <van-field\r\n        v-model=\"article\"\r\n        rows=\"8\"\r\n        type=\"textarea\"\r\n        maxlength=\"3000\"\r\n        placeholder=\"随手分享下你的旅行日志吧！\"\r\n        show-word-limit\r\n      />\r\n    </div>\r\n    <!-- 正文结束 -->\r\n    <!-- 图片上传开始 -->\r\n    <div class=\"picUpload\">\r\n      <van-uploader v-model=\"fileList\" multiple :max-count=\"8\" :after-read=\"afterRead\" accept=\"image/png,image/jpeg,image/jpg\"/>\r\n    </div>\r\n    <!-- 图片上传结束 -->\r\n    <!-- 标题开始 -->\r\n    <van-cell-group>\r\n      <van-field v-model=\"article_tit\" label=\"文章标题\" placeholder=\"请填写文章标题\" label-width=\"4.2em\"/>\r\n    </van-cell-group>\r\n    <!-- 标题结束 -->\r\n    <!-- 城市位置开始 -->\r\n    <van-cell-group>\r\n      <van-field\r\n        readonly\r\n        clickable\r\n        name=\"current_city\"\r\n        :value=\"current_city\"\r\n        label=\"当前城市\"\r\n        label-width=\"4.2em\"\r\n        placeholder=\"点击选择城市\"\r\n        @click=\"showcity = true\"\r\n      />\r\n      <van-popup v-model=\"showcity\" position=\"bottom\">\r\n        <van-picker\r\n          show-toolbar\r\n          :columns=\"city\"\r\n          @confirm=\"oncity\"\r\n          @change=\"onChange\"\r\n          @cancel=\"showcity = false\"\r\n        />\r\n      </van-popup>\r\n    </van-cell-group>\r\n    <!-- 城市位置结束 -->\r\n    <!-- 文章分类开始 -->\r\n    <van-cell-group>\r\n      <van-field\r\n        readonly\r\n        clickable\r\n        name=\"classify\"\r\n        :value=\"classify\"\r\n        label=\"文章分类\"\r\n        label-width=\"4.2em\"\r\n        placeholder=\"点击选择分类\"\r\n        @click=\"showclassify = true\"\r\n      />\r\n      <van-popup v-model=\"showclassify\" position=\"bottom\">\r\n        <van-picker\r\n          show-toolbar\r\n          :columns=\"diaryclassify\"\r\n          @confirm=\"onclassify\"\r\n          @cancel=\"showclassify = false\"\r\n        />\r\n      </van-popup>\r\n    </van-cell-group>\r\n    <!-- 文章分类结束 -->\r\n  </div>\r\n</template>\r\n\r\n<style>\r\n/* 导航按钮 */\r\n.keepDiary .van-button--round{\r\n  border-radius: 50px;\r\n  height: 24px;\r\n}\r\n.keepDiary .van-nav-bar__left, .van-nav-bar__right{\r\n  font-size: 24px;\r\n}\r\n/* 正文 */\r\n.keepDiary .diarytext{\r\n  margin-top: 46px;\r\n}\r\n.keepDiary .diarytext .van-cell{\r\n  padding: 0;\r\n}\r\n.keepDiary .diarytext .van-cell__value--alone{\r\n  background: rgb(250, 250, 250);\r\n  padding: 15px;\r\n}\r\n.keepDiary .diarytext .van-field__control{\r\n  text-indent:2em;\r\n}\r\n/* 图片上传 */\r\n.keepDiary .picUpload{\r\n  margin-left: 8px;\r\n  margin-top: 8px;\r\n}\r\n/* 当前城市 */\r\n.keepDiary .current_city{\r\n  border-top: 1px solid rgb(250, 250, 250);\r\n  border-bottom: 1px solid rgb(250, 250, 250);\r\n}\r\n</style>\r\n\r\n<script>\r\nconst citys = {\r\n  浙江: ['杭州', '宁波', '温州', '嘉兴', '湖州'],\r\n  福建: ['福州', '厦门', '莆田', '三明', '泉州'],\r\n};\r\nexport default {\r\n  data(){\r\n    return {\r\n      // 文章正文\r\n      article:\"\",\r\n      // 文章标题\r\n      article_tit:\"\",\r\n      // 上传的图片\r\n      fileList: [],\r\n      // 当前城市\r\n      current_city:\"\",\r\n      // city: ['杭州', '宁波', '温州', '嘉兴', '湖州'],\r\n      city: [\r\n        {\r\n          values: Object.keys(citys),\r\n          className: 'column1',\r\n        },\r\n        {\r\n          values: citys['浙江'],\r\n          className: 'column2',\r\n          defaultIndex: 2,\r\n        },\r\n      ],\r\n      showcity: false,\r\n\r\n\r\n      // 文章分类\r\n      classify:\"\",\r\n      diaryclassify:[],\r\n      showclassify: false,\r\n      // 是否上传\r\n      data:{}\r\n    }\r\n  },\r\n  methods: {\r\n    // 获取图片读取后的参数\r\n    afterRead(file) {\r\n      console.log(file);\r\n      // 创建表单数据对象\r\n      let formData = new FormData();\r\n      // 如果传的参的content属性存在则为对象\r\n      if (file.hasOwnProperty('content')) {\r\n\r\n        // 直接保存到data中\r\n        formData.append('journal_pic',file.file);\r\n        // 保存在变量data中\r\n        this.data = formData;\r\n\r\n      } else {//否则为数组\r\n\r\n        // 循环遍历获取\r\n        for (let i = 0, n = file.length; i < n; i++) {\r\n          //获取到File对象\r\n          let files = file[i].file;\r\n          // console.log(file[i].file);\r\n          formData.append('journal_pic',files);\r\n        }\r\n        // 保存在变量data中\r\n        this.data = formData;\r\n\r\n      }\r\n    },\r\n\r\n    \r\n    // 城市选择\r\n    oncity(value) {\r\n      this.current_city = value[0] + value[1];\r\n      this.showcity = false;\r\n    },\r\n    // 切换省\r\n    onChange(picker, values) {\r\n      picker.setColumnValues(1, citys[values[0]]);\r\n    },\r\n\r\n\r\n\r\n\r\n    // 分类的选择器\r\n    onclassify(value){\r\n      this.classify = value;\r\n      this.showclassify = false;\r\n    },\r\n    // 发布日志\r\n    release(){\r\n      // 获取登录状态\r\n      let isOnlogin = this.$store.state.isOnlogin;\r\n      // 如果登录状态为1则为登录\r\n      if ( isOnlogin == 1) {\r\n        // 获取当前时间\r\n        let current_time = this.moment().format('x');\r\n\r\n\r\n        // 声明一个变量保存对应的分类id\r\n        let classify_id;\r\n        // 保存获取的分类数组\r\n        let classify_arr = this.$store.state.classify;\r\n        // 循环分类数组\r\n        classify_arr.forEach((value, index, array) => {\r\n          // 如果选中文章分类名等于分类数组里的名\r\n          if ( this.classify ==  value.classify) {\r\n            // 就将当前id赋值给classify_id\r\n            classify_id = value.cid\r\n          }\r\n        })\r\n\r\n\r\n        // 当什么都没没写时不允许提交\r\n        if ( !this.article_tit || !this.article || !this.current_city || !this.classify ) {\r\n          // 没写东西没有动作\r\n          this.$toast.fail('请填写日志内容');\r\n          return\r\n\r\n        } else { // 写了东西\r\n\r\n            // 获取保存的formdata\r\n            let formData = this.data;\r\n    \r\n            // 在表单数据对象中添加数据\r\n            // 日志标题\r\n            formData.set(\"journal_title\",this.article_tit);\r\n            // 日志正文\r\n            formData.set(\"content\",this.article);\r\n            // 发布时间\r\n            formData.set(\"log_time\",current_time);\r\n            // 当前城市\r\n            formData.set(\"journal_city\",this.current_city);\r\n            // 当前分类\r\n            formData.set(\"journal_classify\",classify_id);\r\n            // 用户id\r\n            formData.set(\"users_id\",1);\r\n\r\n            console.log(formData);\r\n            // 提交表单\r\n            this.axios.post('/journal/diaryadd',formData).then( res => {\r\n              // 获取到code为1跳转到首页\r\n              if (res.data.code == 1) {\r\n                this.$notify({\r\n                  type: 'success',\r\n                  message: '发布成功' \r\n                });\r\n                this.$router.push('/');\r\n              }\r\n\r\n            })\r\n        }\r\n\r\n\r\n      } else { // 为未登录\r\n        this.$toast.fail('请登录后发布');\r\n      }\r\n\r\n    }\r\n\r\n\r\n  },\r\n  mounted(){\r\n    // 分类选择器获取数据数组\r\n    let classifys = this.$store.state.classify;\r\n    classifys.forEach((value, index, array) => {\r\n      this.diaryclassify.push(value.classify)\r\n    })\r\n\r\n  }\r\n}\r\n</script>\r\n"]}]}